<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="8d544670-b818-4785-8fc6-ed675f27b386"
             UpgradeCode="94e3fcaa-9171-415f-9e74-97890461ec79"
             Name="TypingTest" Language="1033" Version="1.3.0"
             Manufacturer="Justin Frank, Jason Waataja">

        <Package Id="*" Keywords="Installer" Description="TypingTest Installer"
                 InstallerVersion="200" Languages="1033" Compressed="yes" />

        <Media Id="1" Cabinet="TypingTest.cab" EmbedCab="yes" />

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFiles64Folder">
                <Directory Id="INSTALLDIR" Name="TypingTest" />
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="TypingTest" />
            </Directory>
        </Directory>

        <DirectoryRef Id="INSTALLDIR">
            <Component Id="MainExecutable" Guid="*">
                <File Id="MainExecutable" Source="typingtest.exe" KeyPath="yes" Checksum="yes" />
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="*">
                <Shortcut Id="ApplicationStartMenuShortcut"
                          Name="TypingTest"
			  Description="A simple desktop typing test program."
			  Target="[#MainExecutable]"
			  WorkingDirectory="INSTALLDIR"
			  Icon="TypingTestIcon" />
                <RemoveFolder Id="CleanUpShortcut" Directory="ApplicationProgramsFolder" On="uninstall" />
                <RegistryValue Root="HKCU" Key="Software\Microsoft\TypingTest" Name="installed" Type="integer" Value="1" KeyPath="yes" />
            </Component>
        </DirectoryRef>

        <Feature Id="TypingTest" Title="TypingTest" Level="1">
            <ComponentGroupRef Id="Dependencies" />
	    <ComponentRef Id="MainExecutable" />
	    <ComponentRef Id="ApplicationShortcut" />
        </Feature>

        <UIRef Id="WixUI_Minimal"/>

        <WixVariable Id="WixUILicenseRtf" Value="gpl-3.0.rtf" />

        <Icon Id="TypingTestIcon" SourceFile="typingtest.exe" />
        <Property Id="ARPPRODUCTICON">TypingTestIcon</Property>

    </Product>
</Wix>
